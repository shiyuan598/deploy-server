<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Flask-SocketIO Example</title>
        <!-- <script src="//code.jquery.com/jquery-1.12.4.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.2.0/socket.io.js"></script> -->
    </head>
    <body>
        <h4>Flask-SocketIO Example</h4>
        <div id="log"></div>
        <input type="text" id="message-input" />
        <input type="submit" value="Send" />
        <p></p>
        <button id="btnTest">测试</button>
        <button id="btnFile">文件</button>
        <button id="btnDownload">下载</button>
        <script>
            const socket = new WebSocket("ws://localhost:3001");

            // 连接成功时触发
            socket.onopen = () => {
                console.log("WebSocket连接已建立");
                socket.send("Hi, server");
            };

            // 接收消息时触发
            socket.onmessage = (event) => {
                const message = event.data;
                console.log("收到消息:", message);
            };

            // 连接关闭时触发
            socket.onclose = () => {
                console.log("WebSocket连接已关闭");
            };

            const btnTest = document.getElementById("btnTest");
            btnTest.onclick = () => {
                let url =
                    "http://localhost:3001/deploy/package/json?project=HWL4_X86&package=HWL4_X86-20230607-153750-v1.0.27.tar.gz";
                    // url = "http://localhost:3001/deploy/projects"
                    url = "http://localhost:3001/deploy/vehicle/info?vehicle=J7A01"
                    url = "http://localhost:3001/deploy/task/list"
                fetch(url, {
                    timeout: 5 * 1000
                })
                    .then((v) => v.json())
                    .then(console.info);
            };

            const btnFile = document.getElementById("btnFile");
            btnFile.onclick = () => {
                fetch("http://localhost:3001/deploy/packages", {
                    timeout: 5 * 1000
                }).then(console.info);
            };

            const btnDownload = document.getElementById("btnDownload");
            btnDownload.onclick = () => {
                fetch("http://localhost:3001/deploy/download", {
                    timeout: 5 * 1000
                }).then(console.info);
            };
        </script>
    </body>
</html>
